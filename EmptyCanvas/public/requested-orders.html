 <!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Operations Orders</title>
<!-- CRITICAL: Prevent sidebar links flash before CSS/permissions load -->
<style>
  body.permissions-loading .sidebar li { display: none !important; }
</style>
<link href="/css/style.css" rel="stylesheet"/>
<script src="https://unpkg.com/feather-icons"></script>
</head>
<body class="permissions-loading">
<script>
        (function() {
          try {
            if (window.innerWidth > 768 && localStorage.getItem('ui.sidebarMini') === '1') {
              document.body.classList.add('sidebar-mini');
            }
          } catch(e) {}
        })();
      </script>
<div class="app-container">
<aside class="sidebar">
<div class="sidebar-header">
<h2>Dashboard</h2>
<button aria-expanded="true" aria-label="Toggle sidebar" class="sidebar-toggle" id="sidebar-toggle">
<i data-feather="chevrons-left"></i>
</button>
</div>
<!-- Sidebar: flat links -->
<nav class="sidebar-nav">
<ul class="nav-list">
<li><a class="nav-link" href="/orders"><i data-feather="list"></i><span class="nav-label">Current Orders</span></a></li>
        <li><a class="nav-link" href="/orders/requested"><i data-feather="users"></i><span class="nav-label">Operations Orders</span></a></li>
        <li><a class="nav-link" href="/orders/new"><i data-feather="plus-circle"></i><span class="nav-label">Create New Order</span></a></li>
        <li><a class="nav-link" href="/stocktaking"><i data-feather="archive"></i><span class="nav-label">Stocktaking</span></a></li>
        <li><a class="nav-link" href="/orders/sv-orders"><i data-feather="award"></i><span class="nav-label">S.V schools orders</span></a></li>
        <li><a class="nav-link" href="/expenses"><i data-feather="dollar-sign"></i><span class="nav-label">Expenses</span></a></li>
        <li><a class="nav-link active" href="/expenses/users"><i data-feather="users"></i><span class="nav-label">Expenses by User</span></a></li>
</ul>
</nav>
<div class="sidebar-footer">
<button class="logout-btn" id="logoutBtn"><i data-feather="log-out"></i> Logout</button>
</div>
</aside>
<div class="main-content">
<header class="main-header">
<div class="header-row1">
<div class="left">
<div aria-live="polite" class="greeting-pill">
<span class="greeting-avatar">
<img alt="Hi icon" src="/images/greeting-icon.png"/>
</span>
<div class="greet-text">
<div class="greet-title">Hi, <span data-username="">...</span> ðŸ‘‹</div>
<div class="greet-sub">Manage operations orders</div>
</div>
</div>
<div class="searchbar" id="req-searchbar" role="search" style="margin-left:8px;">
<i data-feather="search"></i>
<input aria-label="Search requested orders" id="requestedSearch" placeholder="Search by reason or user..." type="search"/>
</div>
</div>
<div class="right topbar-right">
<a aria-label="My account" class="account-mini" href="/account" title="My account">
<span class="ico-circle"><img alt="Logo" src="/images/logo.png"/></span>
<span class="label">My account</span>
</a>
</div>
</div>
<div class="header-row2">
<h1 class="page-title">Operations Orders</h1>
</div>
</header>
<main class="page-body">
  <!-- Tabs -->
  <div id="reqTabs" class="portfolio-tabs" role="tablist" aria-label="Requested Orders">
    <a class="tab-portfolio" data-tab="not-started" role="tab" aria-selected="true"
       href="/orders/requested?tab=not-started">Not Started</a>
    <a class="tab-portfolio" data-tab="received" role="tab" aria-selected="false"
       href="/orders/requested?tab=received">Received</a>
    <a class="tab-portfolio" data-tab="delivered" role="tab" aria-selected="false"
       href="/orders/requested?tab=delivered">Delivered</a>
  </div>

  <!-- Orders list (Current Orders card style) -->
  <section class="card">
    <div class="co-cards" id="requested-list">
      <div class="modern-loading" role="status" aria-live="polite">
        <div class="modern-loading__spinner" aria-hidden="true"></div>
        <div class="modern-loading__text">
          Loading requested orders
          <span class="modern-loading__dots" aria-hidden="true"><span></span><span></span><span></span></span>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- ===================== REQUESTED ORDER DETAILS MODAL ===================== -->
<div id="reqOrderModal" class="co-modal-overlay" aria-hidden="true">
  <div class="co-modal-dialog" role="dialog" aria-modal="true" aria-labelledby="reqModalTitle">
    <button type="button" class="co-modal-close" id="reqModalClose" aria-label="Close order details">
      <i data-feather="x"></i>
    </button>

    <div class="co-modal-header">
      <div class="co-modal-head-left">
        <div class="co-modal-status" id="reqModalTitle">â€”</div>
        <div class="co-modal-status-sub" id="reqModalSub">â€”</div>
      </div>
    </div>

    <!-- Tracking progress (same UI as Current Orders) -->
    <div class="co-track-pill" id="reqTrackPill" role="img" aria-label="Order progress">
      <div class="co-track-step" id="reqStep1" title="Order Placed"><i data-feather="package"></i></div>
      <div class="co-track-conn" id="reqConn1"></div>
      <div class="co-track-step" id="reqStep2" title="Under Supervision"><i data-feather="eye"></i></div>
      <div class="co-track-conn" id="reqConn2"></div>
      <div class="co-track-step" id="reqStep3" title="In progress"><i data-feather="activity"></i></div>
      <div class="co-track-conn" id="reqConn3"></div>
      <div class="co-track-step" id="reqStep4" title="Shipped"><i data-feather="truck"></i></div>
      <div class="co-track-conn" id="reqConn4"></div>
      <div class="co-track-step" id="reqStep5" title="Arrived"><i data-feather="home"></i></div>
    </div>

    <div class="co-modal-body">
      <div class="co-modal-meta">
        <div class="co-meta-row"><span>Order ID</span><strong id="reqModalOrderId">â€”</strong></div>
        <div class="co-meta-row"><span>Team member</span><strong id="reqModalCreatedBy">â€”</strong></div>
        <div class="co-meta-row"><span>Date</span><strong id="reqModalDate">â€”</strong></div>
<div class="co-meta-row">
  <span>Received by</span>
  <strong id="reqModalOperationsBy">â€”</strong>
</div>
        <div class="co-meta-row"><span>Components</span><strong id="reqModalComponents">â€”</strong></div>
        <div class="co-meta-row"><span>Total quantity</span><strong id="reqModalTotalQty">â€”</strong></div>
        <div class="co-meta-row"><span>Estimate total</span><strong id="reqModalTotalPrice">â€”</strong></div>
      </div>

      <div class="co-modal-actions ro-actions" id="reqModalActions">
        <button type="button" class="ro-action-btn" id="reqExcelBtn">
          <i data-feather="download"></i>
          Download Excel
        </button>

        <button type="button" class="ro-action-btn" id="reqPdfBtn" style="display:none;">
          <i data-feather="file-text"></i>
          Download PDF
        </button>

        <button type="button" class="ro-action-btn" id="reqReceivedBtn">
          <i data-feather="truck"></i>
          Received by operations
        </button>

        <button type="button" class="ro-action-btn" id="reqReceivedShippedBtn" style="display:none;">
          <i data-feather="check-circle"></i>
          Received
        </button>
      </div>

      <div class="co-modal-items" id="reqModalItems"></div>
    </div>
  </div>
</div>
</div>
</div>
<script>feather.replace();</script>
<script src="/js/common-ui.js"></script>
<script src="/js/requested-orders.js"></script>
</body>
</html>
